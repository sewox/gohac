---
interface Props {
  url: string;
  title?: string;
  description?: string;
}

const { url, title, description } = Astro.props;

// Extract video ID from YouTube/Vimeo URLs
function getVideoEmbedUrl(videoUrl: string): string {
  if (videoUrl.includes('youtube.com/watch') || videoUrl.includes('youtu.be/')) {
    const youtubeId = videoUrl.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/)?.[1];
    if (youtubeId) {
      return `https://www.youtube.com/embed/${youtubeId}`;
    }
  }
  if (videoUrl.includes('vimeo.com/')) {
    const vimeoId = videoUrl.match(/vimeo\.com\/(\d+)/)?.[1];
    if (vimeoId) {
      return `https://player.vimeo.com/video/${vimeoId}`;
    }
  }
  // If it's already an embed URL or direct video URL, return as-is
  return videoUrl;
}

const embedUrl = getVideoEmbedUrl(url);
---

<section class="py-12 md:py-16 bg-gray-900">
  <div class="container mx-auto px-4">
    <div class="max-w-4xl mx-auto">
      {title && <h2 class="text-2xl md:text-3xl font-bold text-white mb-4 text-center">{title}</h2>}
      {description && <p class="text-gray-300 mb-6 text-center">{description}</p>}
      <div class="aspect-video rounded-lg overflow-hidden shadow-lg border border-gray-700">
        <iframe 
          src={embedUrl}
          class="w-full h-full"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        />
      </div>
    </div>
  </div>
</section>

